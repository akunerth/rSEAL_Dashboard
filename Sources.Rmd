---
title: "Recruitment Sources"
author: 
date: "Last Updated: 12/15/2020"
output: 
  html_document:
    theme: flatly
    toc: True
    toc_float: True
    
---

```{r load-packages, echo=FALSE, warning=FALSE, include=FALSE, cache=FALSE}

library(cowplot)
library(readxl)
library(knitr)
library(formattable)
library(ggpubr)
library(frequency)
library(plotly)
library(emmeans)
library(kableExtra)
library(papaja)
library(kableExtra)
library(dplyr)
library(RColorBrewer)
library(tidyverse)
library(ggformula)
library(lubridate)
library(plyr)
library(RColorBrewer)
library(DiagrammeR)
library(DiagrammeRsvg)
library(rsvg)
library(reshape2)
knitr::opts_chunk$set(echo = TRUE)
options(knitr.table.format = "html", knitr.kable.NA = '') 
```

```{r DK Log variable setup, echo = FALSE, message=FALSE}
#DK Data
DKdata <- data.frame(read.csv(file = '/Volumes/psy-ctn/psy-ctn/SNAPLab/SNAP Projects/SEAL/00_rSEAL/02_rSEAL_Data/PreStudy/DK_Log/Raw_Data/RSEALDKLog_DATA.csv'))

DKParsedData <- select (DKdata, rseal_dkid,rseal_dklog_006:rseal_dk_log_complete )

```

```{r, echo=FALSE, fig.width=12, fig.height=4}
df <- data.frame(Time = DKParsedData$rseal_dklog_010___1, Stressed = DKParsedData$rseal_dklog_010___2, Fit = DKParsedData$rseal_dklog_010___3, Privacy = DKParsedData$rseal_dklog_010___4,Comfort = DKParsedData$rseal_dklog_010___5, Cultural = DKParsedData$rseal_dklog_010___6, Understand = DKParsedData$rseal_dklog_010___7, Staff = DKParsedData$rseal_dklog_010___8, Other = DKParsedData$rseal_dklog_010___9, Unknown = DKParsedData$rseal_dklog_010___0)

Source2 = sapply(df, function(x) length(which(x == 1)))
coul <- brewer.pal(4, "Set1") 
coul <- colorRampPalette(coul)(10)
barplot(Source2, col=coul,
        ylim=c(0,10),
        main = "Participant Drop Out Reasons")
```

```{r, echo=FALSE, fig.width=5, fig.height=4, fig.show='hold'}
par(mfrow = c(1:2))

Source1 = table(DKParsedData$rseal_dklog_006)

rownames(Source1) <- c('Unknown', 'DHS', 'WIC', 'Facebook', 'Craigslist', 'Word of Mouth', 'Staff Member')

tbl <- kbl(Source1, col.names = c("Referral Sources", "Counts")) %>%
  kable_styling( bootstrap_options = "striped", full_width = F, position = "float_left", font_size = 16)

tbl
```

```{r, echo=FALSE, fig.width=7, fig.height=4, fig.show='hold', fig.align='center'}

slices <- table(DKParsedData$rseal_dklog_006)
lbls <- c('Unknown', 'DHS', 'WIC', 'Facebook', 'Craigslist', 'Word of Mouth', 'Staff Member')
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie2 <- pie(slices, labels = lbls, radius = 1.0)

```

